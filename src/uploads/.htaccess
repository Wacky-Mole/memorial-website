# Prevent script execution in uploads
Options -Indexes

# Deny execution of common script file types
<FilesMatch "\.(php|php5|phtml|pl|py|jsp|asp|aspx|sh|cgi|exe|bat)$">
  <IfModule mod_authz_core.c>
    Require all denied
  </IfModule>
  <IfModule !mod_authz_core.c>
    Deny from all
  </IfModule>
</FilesMatch>

# Deny access to hidden files
RedirectMatch 404 /\..*$

# Force downloads for risky file types (optional)
<IfModule mod_headers.c>
  <FilesMatch "\.(php|php5|phtml|pl|py|jsp|asp|aspx|sh|cgi)$">
    Header set Content-Disposition "attachment"
  </FilesMatch>
</IfModule>
